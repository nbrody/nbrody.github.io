<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>4D Kleinian Group Visualizer</title>
    <link rel="stylesheet" href="liquidGlass.css">
    <link rel="stylesheet" href="4dKleinian.css">
</head>

<body>
    <div id="container"></div>
    <div id="stats">FPS: 0</div>

    <div class="controls" id="controlPanel">
        <h2>4D Kleinian Group</h2>

        <div class="tabbar">
            <button class="tab-btn active" data-page="spheres">Spheres</button>
            <button class="tab-btn" data-page="render">Render</button>
            <button class="tab-btn" data-page="camera">Camera &amp; Presets</button>
        </div>

        <div class="panel-page active" id="page-render">
        <div class="info">
            <strong>Drag panel</strong> to move, <strong>double-click</strong> to minimize.<br>
            <strong>Drag fractal</strong> to rotate, <strong>scroll</strong> to zoom, <strong>right-click drag</strong> to pan.
        </div>

        <h3>Rendering</h3>

        <div class="control-group">
            <label>Performance Mode</label>
            <select id="performanceMode">
                <option value="fast" selected>Fast (Fixed Spheres)</option>
                <option value="flexible">Flexible (Editable Spheres)</option>
            </select>
            <div class="info" style="font-size: 0.85em; margin-top: 4px;">
                <strong>Fast:</strong> 2-3x faster, uses default sphere preset<br>
                <strong>Flexible:</strong> Edit sphere positions freely
            </div>
        </div>

        <div class="control-group">
            <label>Quality Preset</label>
            <select id="qualityPreset">
                <option value="low">Low (Fast)</option>
                <option value="medium" selected>Medium (Balanced)</option>
                <option value="high">High (Quality)</option>
                <option value="ultra">Ultra (Slow)</option>
                <option value="custom">Custom</option>
            </select>
        </div>

        <div class="control-group">
            <label>Max Iterations: <span id="maxIterValue" class="value-display">25</span></label>
            <input type="range" id="maxIterations" min="1" max="200" value="25" step="1">
        </div>

        <div class="control-group">
            <label>Max March Steps: <span id="maxMarchValue" class="value-display">300</span></label>
            <input type="range" id="maxMarchSteps" min="100" max="2000" value="300" step="50">
        </div>

        <h3>Colors</h3>

        <div class="control-group">
            <label>Color Palette</label>
            <select id="colorPalette">
                <!-- Options will be populated dynamically -->
            </select>
        </div>

        <div class="control-group">
            <label>Coloring Scheme</label>
            <select id="colorScheme">
                <!-- Options will be populated dynamically -->
            </select>
        </div>

        <div class="control-group" id="modulusControl" style="display: none;">
            <label>Modulus Value: <span id="modulusValue" class="value-display">2</span></label>
            <input type="range" id="modulus" min="2" max="20" value="2" step="1">
        </div>
        </div>

        <div class="panel-page" id="page-spheres">
            <h3>Sphere Configuration</h3>

            <div class="control-group">
                <label>Preset</label>
                <select id="spherePreset">
                    <!-- Options will be populated dynamically -->
                </select>
            </div>

            <div class="info">
                <strong>Spheres:</strong> <span id="sphereCount">8</span>
            </div>

            <div id="sphereList" style="max-height: 300px; overflow-y: auto;"></div>

            <button id="addSphere">+ Add Sphere</button>

            <h3>Geometry Parameters</h3>
            <div class="control-group">
                <label>Sphere Radius: <span id="sphereRValue" class="value-display">300.0</span></label>
                <input type="range" id="sphereRadius" min="50" max="500" value="300" step="10">
            </div>
            <div class="control-group">
                <label>Klein Sphere Radius: <span id="kleinRValue" class="value-display">125.0</span></label>
                <input type="range" id="kleinSphereRadius" min="50" max="400" value="125" step="5">
            </div>
            <div class="control-group">
                <label>Scaling Factor: <span id="scalingValue" class="value-display">0.08</span></label>
                <input type="range" id="scalingFactor" min="0.01" max="0.2" value="0.08" step="0.01">
            </div>
        </div>

        <div class="panel-page" id="page-camera">
        <h3>Camera</h3>

        <div class="control-group">
            <label>FOV: <span id="fovValue" class="value-display">60Â°</span></label>
            <input type="range" id="fov" min="30" max="120" value="60" step="5">
        </div>

        <button id="resetCamera">Reset Camera</button>

        <h3>Presets</h3>
        <button id="preset1">Default (Cyan/Purple)</button>
        <button id="preset2" class="secondary">Tight + Fire Bands</button>
        <button id="preset3" class="secondary">Wide + Ocean Flow</button>

        <div class="info" style="margin-top: 12px;">
            <strong>Credit:</strong> Shader by soma_arc (2016)<br>
            Licensed under CC BY-NC-SA 3.0
        </div>
        </div>
    </div>

    <script type="importmap">
    {
        "imports": {
            "three": "https://cdn.jsdelivr.net/npm/three@0.171.0/build/three.module.js",
            "three/addons/": "https://cdn.jsdelivr.net/npm/three@0.171.0/examples/jsm/"
        }
    }
    </script>

    <script type="module" src="./main.js"></script>
</body>

</html>