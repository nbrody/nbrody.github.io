<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quaternion Calculator - Dynamic Primes</title>
    <link rel="stylesheet" href="./style.css">

    <script>
        window.MathJax = {
            tex: { inlineMath: [['$', '$'], ['\\(', '\\)']], displayMath: [['$$', '$$'], ['\\[', '\\]']] },
            svg: { fontCache: 'global' }
        };
    </script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mathquill/0.10.1/mathquill.min.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathquill/0.10.1/mathquill.min.js"></script>
    <script>var MQ = MathQuill.getInterface(2);</script>

    <script type="importmap">
    {
        "imports": {
            "three": "https://unpkg.com/three@0.160.0/build/three.module.js",
            "three/addons/": "https://unpkg.com/three@0.160.0/examples/jsm/"
        }
    }
    </script>
</head>

<body>
    <button id="theme-toggle" class="theme-toggle" aria-label="Toggle Dark Mode">ðŸŒ™</button>
    <div class="container">
        <h1>Quaternion Calculator</h1>
        <p style="text-align: center;">Computations in $\mathsf{SO}_3(\mathbb{Z}[1/n])$</p>

        <div class="so3z-section">
            <h2 class="collapsible-header collapsed"><span class="carat">â–¼</span> \(\mathsf{SO}_3(\mathbb{Z})\)
                Visualization</h2>
            <div class="section-content hidden">
                <div style="display: flex; gap: 20px; flex-wrap: wrap; height: 500px;">
                    <div id="so3z-vis-container"
                        style="flex: 1; min-width: 300px; background: #000; border-radius: 8px; position: relative; overflow: hidden;">
                    </div>
                    <div id="so3z-list-container"
                        style="flex: 1; min-width: 300px; border: 1px solid #ccc; border-radius: 8px; background: #fdfdfd; overflow-y: auto; padding: 10px;">
                        <div style="text-align: center; margin-bottom: 10px;">
                            <button id="btn-gen-so3z"
                                style="padding: 8px 16px; background: #3498db; color: white; border: none; border-radius: 4px; cursor: pointer;">Generate
                                Group (24 elts)</button>
                        </div>
                        <div id="so3z-list"
                            style="display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 8px;">
                            <p style="grid-column: 1/-1; text-align: center; color: #7f8c8d;">Click generate to see
                                elements.</p>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <hr>
        <div class="prime-input-section">
            <label for="prime-input">Odd Primes:</label>
            <span class="mq-input" id="prime-input"
                style="width: 300px; background: white; border: 1px solid #ccc; display: inline-block; padding: 5px; text-align: left;"></span>
            <button id="compute-button">Compute</button>
            <div id="status-message"></div>
        </div>
        <hr>

        <div class="generators-section">
            <h2 class="collapsible-header collapsed"><span class="carat">â–¼</span> Generators</h2>
            <div class="section-content generators-content hidden">
                <div class="generator-vis-panel"
                    style="flex: 1; min-width: 400px; display: flex; flex-direction: column;">
                    <div id="generator-vis-container"
                        style="width: 100%; height: 500px; border: 1px solid #ccc; background: #000; border-radius: 8px;">
                    </div>
                </div>
                <div class="generator-info-panel" style="flex: 1; min-width: 400px; padding: 20px;">
                    <div id="generators-container"
                        style="display: flex; flex-wrap: wrap; gap: 20px; justify-content: center; overflow-y: auto; max-height: 500px;">
                        <div id="generators-list" style="display: none;"></div>
                        <!-- Hidden but kept for compatibility if needed -->
                    </div>
                </div>
            </div>
        </div>

        <hr>
        <h2 class="collapsible-header collapsed"><span class="carat">â–¼</span> Interactive Cayley Graph</h2>
        <div class="section-content hidden">
            <div class="controls">
                <label for="gen-x">X-Axis:</label><select id="gen-x"></select>
                <label for="gen-y">Y-Axis:</label><select id="gen-y"></select>
                <label for="depth-slider">Depth:</label>
                <input type="range" id="depth-slider" min="1" max="12" value="4">
                <span id="depth-value">4</span>
            </div>
            <div id="vis-container"></div>
        </div>

        <hr>
        <h2 class="collapsible-header collapsed"><span class="carat">â–¼</span> Square Complex</h2>
        <div class="section-content hidden">
            <div id="square-complex-container"></div>
        </div>

        <hr>
        <h2 class="collapsible-header collapsed"><span class="carat">â–¼</span> Multiplication</h2>
        <div class="section-content hidden">
            <div class="controls">
                <span class="mq-input" id="mult-expr"
                    style="width: 400px; background: white; border: 1px solid #ccc; display: inline-block; padding: 5px;"></span>
                <button id="btn-multiply">Multiply</button>
                <input type="checkbox" id="mult-primitize"> <label for="mult-primitize">Primitize</label>
            </div>
            <div id="mult-result"></div>
        </div>

        <hr>
        <h2 class="collapsible-header collapsed"><span class="carat">â–¼</span> Word Calculator</h2>
        <div class="section-content hidden">
            <div style="display: flex; gap: 20px; padding: 20px;">
                <div style="flex: 1;">
                    <strong>a = </strong><span class="mq-input" id="word-gen-a"
                        style="width: 80%; background: white; border: 1px solid #ccc; display: inline-block; padding: 5px;"></span><br><br>
                    <strong>b = </strong><span class="mq-input" id="word-gen-b"
                        style="width: 80%; background: white; border: 1px solid #ccc; display: inline-block; padding: 5px;"></span>
                </div>
                <div style="flex: 2;">
                    <textarea id="word-expr"
                        style="width: 100%; height: 120px; background: white; border: 1px solid #ccc; display: block; padding: 10px; font-family: monospace; font-size: 14px; box-sizing: border-box;"></textarea>
                    <button id="btn-calc-word">Calculate</button>
                </div>
            </div>
            <div id="word-result"></div>
        </div>

        <hr>
        <h2 class="collapsible-header collapsed"><span class="carat">â–¼</span> Factor Complex</h2>
        <div class="section-content hidden">
            <div class="controls">
                <span class="mq-input" id="factor-q"
                    style="width: 200px; background: white; border: 1px solid #ccc; display: inline-block; padding: 5px;"></span>
                <button id="btn-factor">Factor</button>
                <input type="checkbox" id="factor-labels-vertices"> V
                <input type="checkbox" id="factor-labels-edges"> E
                <input type="checkbox" id="factor-labels-axes" checked> A
            </div>
            <div id="factor-result"></div>
            <div id="factor-vis-container"
                style="width: 100%; height: 500px; border: 1px solid #ccc; background: #fff;"></div>
            <div id="factor-path-display"></div>
        </div>

        <hr>
        <h2 class="collapsible-header collapsed"><span class="carat">â–¼</span> Tree Visualization</h2>
        <div class="section-content hidden">
            <div class="controls">
                <span id="tree-q-mq" class="mq-input"
                    style="min-width: 200px; padding: 5px; background: white; border: 1px solid #ccc; display: inline-block;"></span>
                <button id="btn-tree">Show Tree</button>
            </div>
            <div id="tree-result"></div>
            <div id="tree-vis-container" style="width: 100%; height: 500px; border: 1px solid #ccc; background: #fff;">
            </div>
        </div>
    </div>

    <script type="module" src="./main.js"></script>
</body>

</html>