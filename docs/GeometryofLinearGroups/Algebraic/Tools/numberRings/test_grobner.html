<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gröbner Basis Test</title>
    <style>
        body {
            font-family: monospace;
            padding: 20px;
            background: #f5f5f5;
        }
        .test {
            background: white;
            padding: 15px;
            margin: 10px 0;
            border-left: 4px solid #667eea;
        }
        .pass { border-left-color: #28a745; }
        .fail { border-left-color: #dc3545; }
        h2 { color: #667eea; }
    </style>
</head>
<body>
    <h1>Gröbner Basis Z-Arithmetic Tests</h1>
    <div id="results"></div>

    <script src="numberRing.js"></script>
    <script src="grobnerBases.js"></script>
    <script>
        const results = document.getElementById('results');

        function test(name, fn) {
            try {
                const result = fn();
                results.innerHTML += `<div class="test pass">✓ ${name}<br>${result}</div>`;
            } catch (e) {
                results.innerHTML += `<div class="test fail">✗ ${name}<br>Error: ${e.message}</div>`;
            }
        }

        // Test 1: Basic monomial operations
        test("Monomial integer arithmetic", () => {
            const m1 = new Monomial([2, 1], 6);
            const m2 = new Monomial([1, 1], 3);
            const m3 = m1.multiply(m2);
            return `6x₁²x₂ * 3x₁x₂ = ${m3.coeff}x₁³x₂² (coeff=${m3.coeff}, expected 18)`;
        });

        // Test 2: Polynomial content and primitive part
        test("Content and primitive part", () => {
            const p = MultivariatePolynomial.parse("6*x_1^2 + 9*x_1 + 12");
            const content = p.content();
            const primitive = p.primitivePart();
            return `Poly: ${p.toString()}<br>Content: ${content} (expected 3)<br>Primitive: ${primitive.toString()}`;
        });

        // Test 3: Simple Gröbner basis
        test("Simple Gröbner basis", () => {
            const f1 = MultivariatePolynomial.parse("x_1^2 - 1");
            const f2 = MultivariatePolynomial.parse("x_1*x_2 - x_2");
            const result = buchberger([f1, f2], 'lex', { maxIterations: 100 });
            return `Input: x₁²-1, x₁x₂-x₂<br>Basis size: ${result.basis.length}<br>` +
                   `Basis: ${result.basis.map(b => b.toString()).join(', ')}<br>` +
                   `All integer coeffs: ${result.basis.every(b => b.terms.every(t => Number.isInteger(t.coeff)))}`;
        });

        // Test 4: Circle intersection
        test("Circle intersection (geometric)", () => {
            const f1 = MultivariatePolynomial.parse("x_1^2 + x_2^2 - 1");
            const f2 = MultivariatePolynomial.parse("x_1 - x_2");
            const result = buchberger([f1, f2], 'lex', { maxIterations: 100 });
            return `Input: x₁²+x₂²-1, x₁-x₂ (circle intersecting line)<br>` +
                   `Basis size: ${result.basis.length}<br>` +
                   `Basis: ${result.basis.map(b => b.toString()).join('<br>&nbsp;&nbsp;&nbsp;&nbsp;')}<br>` +
                   `Stats: ${result.stats.iterations} iterations, ${result.stats.primitivizationsPerformed} primitivizations`;
        });

        // Test 5: Verify all coefficients are integers
        test("Integer coefficient verification", () => {
            const f1 = MultivariatePolynomial.parse("2*x_1^2 + 3*x_2");
            const f2 = MultivariatePolynomial.parse("5*x_1*x_2 - 7");
            const result = buchberger([f1, f2], 'grevlex', { maxIterations: 100 });
            const allIntegers = result.basis.every(poly =>
                poly.terms.every(term => Number.isInteger(term.coeff))
            );
            const allPrimitive = result.basis.every(poly => poly.content() === 1);
            return `All coefficients are integers: ${allIntegers}<br>` +
                   `All polynomials primitive: ${allPrimitive}<br>` +
                   `Basis: ${result.basis.map(b => b.toString()).join(', ')}`;
        });

        // Test 6: Twisted cubic
        test("Twisted cubic curve", () => {
            const f1 = MultivariatePolynomial.parse("x_2 - x_1^2");
            const f2 = MultivariatePolynomial.parse("x_3 - x_1^3");
            const result = buchberger([f1, f2], 'lex', { maxIterations: 100 });
            return `Input: x₂-x₁², x₃-x₁³<br>` +
                   `Basis size: ${result.basis.length}<br>` +
                   `Basis: ${result.basis.map(b => b.toString()).join('<br>&nbsp;&nbsp;&nbsp;&nbsp;')}`;
        });

        // Summary
        const allTests = document.querySelectorAll('.test');
        const passed = document.querySelectorAll('.test.pass').length;
        const failed = document.querySelectorAll('.test.fail').length;
        results.innerHTML += `<h2>Summary: ${passed} passed, ${failed} failed</h2>`;
    </script>
</body>
</html>
